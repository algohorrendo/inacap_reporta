<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>INACAP Reporta - Reportar Incidencia</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'reportes/reporte_incidencias/style.css' %}">
</head>
<body>
    <div class="header">
        <h1>INACAP Reporta</h1>
        <div class="user-info">
            <strong>Usuario:</strong> {{ user.first_name|default:user.username }} | 
            <a href="{% url 'logout' %}">Cerrar Sesi√≥n</a>
        </div>
    </div>

    <div class="reporte-container">
        <h2>Reportar Nueva Incidencia</h2>
        
        {% if success %}
            <div class="success-message">
                ‚úÖ {{ mensaje }}
            </div>
        {% endif %}
        
        {% if error %}
            <div class="error-message">
                ‚ö†Ô∏è {{ error }}
            </div>
        {% endif %}
        
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="hidden" id="hora_local" name="hora_local" value="">

            <div class="form-group">
                <label for="titulo">T√≠tulo de la Incidencia:</label>
                <input type="text" id="titulo" name="titulo" required placeholder="Ej: Problema con computadora del aula 201">
            </div>
            
            <div class="form-group">
                <label for="categoria">Categor√≠a:</label>
                <select id="categoria" name="categoria" required>
                    <option value="">Selecciona una categor√≠a</option>
                    <option value="tecnologia">Tecnolog√≠a</option>
                    <option value="infraestructura">Infraestructura</option>
                    <option value="servicios">Servicios</option>
                    <option value="academico">Acad√©mico</option>
                    <option value="otro">Otro</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="descripcion">Descripci√≥n Detallada:</label>
                <textarea id="descripcion" name="descripcion" required placeholder="Describe el problema en detalle..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="ubicacion">Ubicaci√≥n:</label>
                <input type="text" id="ubicacion" name="ubicacion" required placeholder="Ej: Aula 201, Edificio A">
            </div>
            
            <div class="form-group">
                <label for="urgencia">Nivel de Urgencia:</label>
                <select id="urgencia" name="urgencia" required>
                    <option value="">Selecciona urgencia</option>
                    <option value="baja">Baja</option>
                    <option value="media">Media</option>
                    <option value="alta">Alta</option>
                    <option value="critica">Cr√≠tica</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="foto">üì∑ Foto de la Incidencia (Opcional):</label>
                <input type="file" id="foto" name="foto" accept="image/*" style="
                    width: 100%;
                    padding: 12px;
                    border: 2px dashed #667eea;
                    border-radius: 8px;
                    background: #f8f9fa;
                    font-size: 14px;
                    color: #666;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">
                <small style="color: #666; font-size: 12px; font-style: italic; margin-top: 8px; display: block;">
                    üìù Formatos permitidos: JPG, PNG, GIF. M√°ximo 5MB.
                </small>
            </div>
            
            <button type="submit" class="btn-primary">Enviar Reporte</button>
            <button type="reset" class="btn-secondary">Limpiar</button>
        </form>
        
        <div class="nav-links">
            <a href="{% url 'panel_usuario' %}">Volver al Panel</a>
        </div>
    </div>

    <script>
    window.addEventListener('DOMContentLoaded', function() {
        const now = new Date();
        const pad = n => n.toString().padStart(2,'0');
        const formatted = now.getFullYear() + '-' +
                          pad(now.getMonth()+1) + '-' +
                          pad(now.getDate()) + ' ' +
                          pad(now.getHours()) + ':' +
                          pad(now.getMinutes()) + ':' +
                          pad(now.getSeconds());
        document.getElementById('hora_local').value = formatted;
    });
    </script>
    <script src="{% static 'reportes/reporte_incidencias/script.js' %}"></script>
</body>
</html>
